# Example configuration for inpainting (regenerate specific residues of a given structure)
# Usage: uv run python -m lobster.cmdline.generate --config-path "../hydra_config/experiment" --config-name generate_inpainting

# Output directory
output_dir: "./examples/generated_inpainting_test"

# Random seed for reproducibility
seed: 54321

# Model configuration
model:
  _target_: lobster.model.gen_ume.UMESequenceStructureEncoderLightningModule
  ckpt_path: "s3://prescient-lobster/ume/gen_ume/checkpoints/gen-ume-small-PDB-90M.ckpt" 

# Generation settings
generation:
  mode: inpainting
  # Residues to regenerate. Options:
  #   - Specific ranges: "113-133" or "10-20,30-40"
  #   - Specific indices: "10,15,20,25"
  #   - Random regions: "random | N | min-max" (e.g., "random | 3 | 10-30" for 3 random non-overlapping regions, each 10-30 residues)
  #   - Sequence pattern: "GGGG" (finds and inpaints consecutive stretches of ≥4 Glycines; longer runs are fully inpainted)
  #   - Empty string "" = no masking
  # Examples:
  #   - "GGGG" finds any stretch with 4+ consecutive Glycines (e.g., "...GGGGGGGGGG..." → all 10 G's inpainted)
  #   - "AAA" finds any stretch with 3+ consecutive Alanines
  #   - Works per-sample: different sequences may have different pattern matches
  mask_indices_sequence: "20-50"
  mask_indices_structure: ""
  nsteps: 200          # Number of generation steps
  batch_size: 1        # Process 1 structure at a time
  n_trials: 1          # Number of trials for best output selection
  n_designs_per_structure: 10  # Number of designs to generate per structure

  #Generation parameters
  temperature_seq: 0.16423763902324678
  temperature_struc: 1.0
  stochasticity_seq: 20
  stochasticity_struc: 10
  asynchronous_sampling: false

  # Input structures - update these paths to your PDB files
  # Examples of different input formats:
  # Single file: input_structures: "/path/to/structure.pdb"
  # Directory: input_structures: "/path/to/pdb/directory/"
  # Glob pattern: input_structures: "/path/to/structures/*.pdb"
  # List of files: input_structures: ["/path/to/file1.pdb", "/path/to/file2.pdb"]
  input_structures: "test_data/inv_folding/9jl9.pdb"

  # Enable ESMFold validation
  use_esmfold: true
  max_length: 512

  # Optional: Specify which chain groups to predict with ESMFold
  # Each inner list is a group of chain IDs to fold together
  # If null or not specified, all chains are folded together (default behavior)
  # Examples:
  #   - null: Fold all chains together (default)
  #   - [[200, 400]]: Only predict chains 200 and 400 together
  #   - [[200, 400], [0, 200, 400]]: Predict two configurations - chains 200+400, then all three chains
  #   - [[0], [200], [400], [0, 200, 400]]: Predict each chain alone and all together
  # Note: Chain IDs should match values in the structure's chain tensor
  esmfold_chain_groups:
    - null

  # Not used for inpainting
  length: null
  num_samples: null
